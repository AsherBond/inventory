<?xml version="1.0"?>
<!--
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">
    <!-- Source -->
    <preference for="Magento\InventoryApi\Api\SourceRepositoryInterface" type="Magento\Inventory\Model\SourceRepository"/>
    <preference for="Magento\InventoryApi\Api\Data\SourceInterface" type="Magento\Inventory\Model\Source" />
    <preference for="Magento\InventoryApi\Api\Data\SourceCarrierLinkInterface" type="Magento\Inventory\Model\SourceCarrierLink"/>
    <preference for="Magento\InventoryApi\Api\Data\SourceSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
    <preference for="Magento\Inventory\Model\SourceCarrierLinkManagementInterface" type="Magento\Inventory\Model\SourceCarrierLinkManagement"/>
    <preference for="Magento\Inventory\Model\Source\Command\GetInterface" type="Magento\Inventory\Model\Source\Command\Get"/>
    <preference for="Magento\Inventory\Model\Source\Command\GetListInterface" type="Magento\Inventory\Model\Source\Command\GetList"/>
    <preference for="Magento\Inventory\Model\Source\Command\SaveInterface" type="Magento\Inventory\Model\Source\Command\Save"/>
    <!-- TODO: describe bug -->
    <preference for="Magento\Inventory\Model\Source\Validator\SourceValidatorInterface" type="Magento\Inventory\Model\Source\Validator\ValidatorChain"/>
    <type name="Magento\Inventory\Model\Source\Validator\ValidatorChain">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="name" xsi:type="object">Magento\Inventory\Model\Source\Validator\NameValidator</item>
                <item name="postcode" xsi:type="object">Magento\Inventory\Model\Source\Validator\PostcodeValidator</item>
                <item name="country" xsi:type="object">Magento\Inventory\Model\Source\Validator\CountryValidator</item>
                <item name="carrier_links" xsi:type="object">Magento\Inventory\Model\Source\Validator\CarrierLinks</item>
            </argument>
        </arguments>
    </type>
    <type name="Magento\Inventory\Model\Source\Command\Save">
        <arguments>
            <argument name="sourceValidator" xsi:type="object">Magento\Inventory\Model\Source\Validator\ValidatorChain</argument>
        </arguments>
    </type>
    <!-- Source Item -->
    <preference for="Magento\InventoryApi\Api\SourceItemRepositoryInterface" type="Magento\Inventory\Model\SourceItemRepository"/>
    <preference for="Magento\InventoryApi\Api\SourceItemsSaveInterface" type="Magento\Inventory\Model\SourceItem\Command\SourceItemsSave"/>
    <preference for="Magento\InventoryApi\Api\Data\SourceItemInterface" type="Magento\Inventory\Model\SourceItem"/>
    <preference for="Magento\InventoryApi\Api\Data\SourceItemSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
    <preference for="Magento\Inventory\Model\SourceItem\Command\DeleteInterface" type="Magento\Inventory\Model\SourceItem\Command\Delete"/>
    <preference for="Magento\Inventory\Model\SourceItem\Command\GetListInterface" type="Magento\Inventory\Model\SourceItem\Command\GetList"/>
    <!-- Stock -->
    <preference for="Magento\InventoryApi\Api\StockRepositoryInterface" type="Magento\Inventory\Model\StockRepository"/>
    <preference for="Magento\InventoryApi\Api\Data\StockInterface" type="Magento\Inventory\Model\Stock"/>
    <preference for="Magento\InventoryApi\Api\Data\StockSearchResultsInterface" type="Magento\Framework\Api\SearchResults"/>
    <preference for="Magento\Inventory\Model\Stock\Command\DeleteByIdInterface" type="Magento\Inventory\Model\Stock\Command\DeleteById"/>
    <preference for="Magento\Inventory\Model\Stock\Command\GetInterface" type="Magento\Inventory\Model\Stock\Command\Get"/>
    <preference for="Magento\Inventory\Model\Stock\Command\GetListInterface" type="Magento\Inventory\Model\Stock\Command\GetList"/>
    <preference for="Magento\Inventory\Model\Stock\Command\SaveInterface" type="Magento\Inventory\Model\Stock\Command\Save"/>
    <!-- TODO: describe bug -->
    <preference for="Magento\Inventory\Model\Stock\Validator\StockValidatorInterface" type="Magento\Inventory\Model\Stock\Validator\ValidatorChain"/>
    <type name="Magento\Inventory\Model\Stock\Validator\ValidatorChain">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="name" xsi:type="object">Magento\Inventory\Model\Stock\Validator\NameValidator</item>
            </argument>
        </arguments>
    </type>
    <type name="Magento\Inventory\Model\Stock\Command\Save">
        <arguments>
            <argument name="stockValidator" xsi:type="object">Magento\Inventory\Model\Stock\Validator\ValidatorChain</argument>
        </arguments>
    </type>
    <!-- StockSourceLink -->
    <preference for="Magento\InventoryApi\Api\AssignSourcesToStockInterface" type="Magento\Inventory\Model\StockSourceLink\Command\AssignSourcesToStock"/>
    <preference for="Magento\InventoryApi\Api\GetAssignedSourcesForStockInterface" type="Magento\Inventory\Model\StockSourceLink\Command\GetAssignedSourcesForStock"/>
    <preference for="Magento\InventoryApi\Api\UnassignSourceFromStockInterface" type="Magento\Inventory\Model\StockSourceLink\Command\UnassignSourceFromStock"/>

    <!-- StockItem Indexer -->
    <preference for="Magento\Inventory\Indexer\StockItem\Service\GetAssignedStocksInterface" type="Magento\Inventory\Indexer\StockItem\Service\GetAssignedStocks"/>
    <preference for="Magento\Inventory\Indexer\Scope\IndexSwitcherInterface" type="Magento\Inventory\Indexer\Scope\IndexSwitcher"/>
    <type name="Magento\Inventory\Indexer\Scope\IndexSwitcher">
        <arguments>
            <argument name="indexScopeResolver" xsi:type="object">\Magento\Inventory\Indexer\Scope\ScopeProxy</argument>
        </arguments>
    </type>
    <type name="Magento\Inventory\Indexer\StockItem\IndexHandler">
        <arguments>
            <argument name="indexStructure" xsi:type="object">Magento\Inventory\Indexer\StockItem\IndexStructure</argument>
            <argument name="indexScopeResolver" xsi:type="object">\Magento\Inventory\Indexer\Scope\ScopeProxy</argument>
            <argument name="batchSize" xsi:type="string">100</argument>
        </arguments>
    </type>
    <type name="Magento\Inventory\Indexer\Scope\ScopeProxy">
        <arguments>
            <argument name="states" xsi:type="array">
                <item name="use_temporary_table" xsi:type="string">Magento\Inventory\Indexer\Scope\TemporaryResolver</item>
                <item name="use_main_table" xsi:type="string">Magento\Framework\Indexer\ScopeResolver\IndexScopeResolver</item>
            </argument>
        </arguments>
    </type>
</config>
